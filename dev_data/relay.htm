<!DOCTYPE html>
<html>
 <head>
  <meta http-equiv="Content-type" content="text/html; charset=utf-8">
  <script src="js/build.chart.js?v07.06.2017" charset="utf-8"></script>
  <!-- <link rel="stylesheet" type="text/css" href="css/chartist.min.css">
<script src="js/chartist.min.js" charset="utf-8"></script>
<script type="text/javascript" src="js/chart.js"></script> -->
  <link rel="stylesheet" type="text/css" href="css/build.css?v07.06.2017">
  <!-- <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="css/style.css"> -->
  <script type="text/javascript" src="js/function.js?v07.06.2017"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Options page</title>
  <script type="text/javascript">
   var myVar;
   function handleServerResponse(stage,jsonResponse){
    val('off-on',(jsonResponse.state=='0'?jsonResponse.LangOn:jsonResponse.LangOff));
    if (stage != 'next') {
     if (!jsonResponse.g72895 && searchModule(jsonResponse.module,"temperature") == 'yes') loadChart('ct-chart','sensor.json');
     if (!jsonResponse.g85723 && searchModule(jsonResponse.module,"analog") == 'yes') loadChart('ct-analog','analog.json');
    }
    if (!jsonResponse.g42843) loadTimer("timer-list","relay");
   }
   function sonoff(submit){
    server = "/sonoff";
    document.getElementById('url1').innerHTML='<a href="http://'+document.domain+server+'" target="_blank">http://'+document.domain+server+'<\/a>';
    if(navigator.onLine) {
     xhr = new XMLHttpRequest();
     xhr.open("GET","https://api.ipify.org?format=text",true);
     xhr.onload = function () {
      if (xhr.readyState === xhr.DONE) {
       if (xhr.status === 200) {
        document.getElementById('url2').innerHTML='<a href="http://'+(jsonResponse.ddnsName?(jsonResponse.ddnsName+':'+jsonResponse.ddnsPort+server):xhr.responseText+':'+jsonResponse.ddnsPort+server)+'" target="_blank">http://'+(jsonResponse.ddnsName?(jsonResponse.ddnsName+':'+jsonResponse.ddnsPort+server):xhr.responseText+':'+jsonResponse.ddnsPort+server)+'<\/a>';
       }
      }
     };
     xhr.send(null);
    }
    send_request(submit,server);
   }
  </script>
 </head>
 <body onload="load('first');">
  <div class="container loader-bg">
   <div class="row hidden" id="content">
    <h1 id="title">{{LangOptions1}}</h1>
    <div class="col-sm-offset-1 col-sm-10 col-md-offset-2 col-md-8 col-lg-offset-3 col-lg-6">
     <h5 class="alert-danger">{{SSDP}}</h5>

     <div class="btn-group" id="language">
      <a href="#" class="btn btn-default dropdown-toggle" onclick="toggle('language-set');loadLang('language-set');return false">{{lang}} <span class="caret"></span></a>
      <ul class="dropdown-menu hidden" id="language-set"><li><a href="#">{{LangLoading}}</a></li></ul>
     </div>

     <a class="btn btn-block btn-danger" id="btn-devices" href="/">{{LangDevices}}</a>
     <a class="btn btn-block btn-default" href="/page.htm?setup"><i class="opt-img"></i> {{LangSetting3}}</a>

     <hr>

     <div class="alert alert-dismissible alert-info {{g2342}}"><button class="close" onclick="hide('g2342',this);" type="button">×</button>{{LangIfttt1}}<span id="hide" class="hidden">{{LangIfttt2}}</span></div>

     <!-- CHART TEMPERATURE Module - START -->
     <div class="module-temperature hidden {{g72895}}">
      <button class="close" onclick="hide('g72895',this);" type="button">×</button>
      <a href="/page.htm?chart&sensor" target="_blank" class="close"><i class="popup-img"></i></a>
      <div id="ct-chart" style="height:200px;margin-left:-20px"></div>
      <hr>
     </div>
     <!-- CHART TEMPERATURE Module - END -->

     <input class="btn btn-block btn-lg btn-primary" id="off-on" value="{{LangOnOff}}" onclick="sonoff(this);" type="button">
     <hr>

     <!-- TIMERS Module - START -->
     <h2>{{LangTimer}}</h2>
     <div class="alert alert-dismissible alert-warning {{g42843}}">
      <button class="close" onclick="hide('g42843',this);" type="button">×</button>
      <ul id="timer-list"><li>{{LangLoading}}</li></ul>
     </div>
     <a class="btn btn-block btn-default" href="/timer.htm">{{LangTime3}}</a>
     <hr>
     <!-- TIMERS Module - END -->

     <!-- CHART ANALOG Module - START -->
     <div class="module-analog hidden {{g85723}}">
      <button class="close" onclick="hide('g85723',this);" type="button">×</button>
      <a href="/page.htm?chart&analog" target="_blank" class="close"><i class="popup-img"></i></a>
      <div id="ct-analog" style="height:200px;margin-left:-20px"></div>
      <hr>
     </div>
     <!-- CHART ANALOG Module - END -->

     <!-- MOVEMENT Module - START -->
     <div class="module-movement hidden {{g8359}}">
      <button class="close" onclick="hide('g8359',this);" type="button">×</button>
      <h2>{{LangPir1}}</h2>
      <div class="row">
       <div class="col-sm-8">
        <div class="alert alert-dismissible alert-info">{{LangPir2}}</div>
       </div>
       <div class="col-sm-4">
        <div class="input-group">
         <input id="pir-time" value="{{pirTime}}" class="form-control" pattern="[0-9]*[.,]?[0-9]+"><span class="input-group-addon">{{LangSec}}</span>
        </div>
        <div class="btn-group" style="width:100%">
         <input class="btn btn-success" style="width:60%" value="{{LangSave}}" onclick="send_request(this,'/pir?t='+val('pir-time'));" type="button">
         <input class="btn btn-default" style="width:40%" value="{{LangOff.}}" onclick="val('pir-time','0');send_request(this,'/pir?t=0');" type="button">
        </div>
       </div>
      </div>
      <hr>
     </div>
     <!-- MOVEMENT Module - END -->

     <a class="btn btn-block btn-default" href="/page.htm?setup"><i class="opt-img"></i> {{LangSetting3}}</a>
    </div>
   </div>
  </div>
 </body>
</html>
